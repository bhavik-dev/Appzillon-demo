/*! ESAPI-JS - v0.1.3
 *  Release on: 2015-06-08
 *  https://www.owasp.org/index.php/Category:OWASP_Enterprise_Security_API
 *  Copyright (c) 2015 OWASP
 *  Licensed BSD */
;var $namespace=function(name,separator,container){var ns=name.split(separator||"."),o=container||window,i,len;for(i=0,len=ns.length;i<len;i++){o=o[ns[i]]=o[ns[i]]||{}}return o};var $type=function(oVar,oType){if(!oVar instanceof oType){throw new SyntaxError()}};if(!$){var $=function(sElementID){return document.getElementById(sElementID)}}if(!Array.prototype.each){Array.prototype.each=function(fIterator){if(typeof fIterator!="function"){throw"Illegal Argument for Array.each"}for(var i=0;i<this.length;i++){fIterator(this[i])}}}if(!Array.prototype.contains){Array.prototype.contains=function(srch){var found=false;this.each(function(e){if((srch.equals&&srch.equals(e))||e==srch){found=true;return}});return found}}if(!Array.prototype.containsKey){Array.prototype.containsKey=function(srch){for(var key in this){if(key.toLowerCase()==srch.toLowerCase()){return true}}return false}}if(!Array.prototype.getCaseInsensitive){Array.prototype.getCaseInsensitive=function(key){for(var k in this){if(k.toLowerCase()==key.toLowerCase()){return this[k]}}return null}}if(!String.prototype.charCodeAt){String.prototype.charCodeAt=function(idx){var c=this.charAt(idx);for(var i=0;i<65536;i++){var s=String.fromCharCode(i);if(s==c){return i}}return 0}}if(!String.prototype.endsWith){String.prototype.endsWith=function(test){return this.substr((this.length-test.length),test.length)==test}}if(!Exception){var Exception=function(sMsg,oException){this.cause=oException;this.errorMessage=sMsg};Exception.prototype=Error.prototype;Exception.prototype.getCause=function(){return this.cause};Exception.prototype.getMessage=function(){return this.message};Exception.prototype.getStackTrace=function(){if(this.callstack){return this.callstack}if(this.stack){var lines=stack.split("\n");for(var i=0,len=lines.length;i<len;i++){if(lines[i].match(/^\s*[A-Za-z0-9\=+\$]+\(/)){this.callstack.push(lines[i])}}this.callstack.shift();return this.callstack}else{if(window.opera&&this.message){var lines=this.message.split("\n");for(var i=0,len=lines.length;i<len;i++){if(lines[i].match(/^\s*[A-Za-z0-9\=+\$]+\(/)){var entry=lines[i];if(lines[i+1]){entry+=" at "+lines[i+1];i++}this.callstack.push(entry)}}this.callstack.shift();return this.callstack}else{var currentFunction=arguments.callee.caller;while(currentFunction){var fn=currentFunction.toString();var fname=fn.substring(fn.indexOf("function")+8,fn.indexOf("("))||"anonymous";this.callstack.push(fname);currentFunction=currentFunction.caller}return this.callstack}}};Exception.prototype.printStackTrace=function(writer){var out=this.getMessage()+"|||"+this.getStackTrace().join("|||");if(this.cause){if(this.cause.printStackTrace){out+="||||||Caused by "+this.cause.printStackTrace().replace("\n","|||")}}if(!writer){return writer.replace("|||","\n")}else{if(writer.value){writer.value=out.replace("|||","\n")}else{if(writer.writeln){writer.writeln(out.replace("|||","\n"))}else{if(writer.innerHTML){writer.innerHTML=out.replace("|||","<br/>")}else{if(writer.textContent){writer.textContent=out.replace("|||","<br/>")}else{if(writer.append){writer.append(out.replace("|||","\n"))}else{if(writer instanceof Function){writer(out.replace("|||","\n"))}}}}}}}}}if(!RuntimeException){var RuntimeException=Exception}if(!IllegalArgumentException){var IllegalArgumentException=Exception}if(!DateFormat){var DateFormat=function(sFmt){var fmt=sFmt;var replaceChars={longMonths:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longDays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],d:function(date){return(date.getDate()<10?"0":"")+date.getDate()},D:function(date){return replaceChars.shortDays[date.getDay()]},j:function(date){return date.getDate()},l:function(date){return replaceChars.longDays[date.getDay()]},N:function(date){return date.getDay()+1},S:function(date){return(date.getDate()%10==1&&date.getDate()!=11?"st":(date.getDate()%10==2&&date.getDate()!=12?"nd":(date.getDate()%10==3&&date.getDate()!=13?"rd":"th")))},w:function(date){return date.getDay()},z:function(date){return"Not Yet Supported"},W:function(date){return"Not Yet Supported"},F:function(date){return replaceChars.longMonths[date.getMonth()]},m:function(date){return(date.getMonth()<9?"0":"")+(date.getMonth()+1)},M:function(date){return replaceChars.shortMonths[date.getMonth()]},n:function(date){return date.getMonth()+1},t:function(date){return"Not Yet Supported"},L:function(date){return(((date.getFullYear()%4==0)&&(date.getFullYear()%100!=0))||(date.getFullYear()%400==0))?"1":"0"},o:function(date){return"Not Supported"},Y:function(date){return date.getFullYear()},y:function(date){return(""+date.getFullYear()).substr(2)},a:function(date){return date.getHours()<12?"am":"pm"},A:function(date){return date.getHours()<12?"AM":"PM"},B:function(date){return"Not Yet Supported"},g:function(date){return date.getHours()%12||12},G:function(date){return date.getHours()},h:function(date){return((date.getHours()%12||12)<10?"0":"")+(date.getHours()%12||12)},H:function(date){return(date.getHours()<10?"0":"")+date.getHours()},i:function(date){return(date.getMinutes()<10?"0":"")+date.getMinutes()},s:function(date){return(date.getSeconds()<10?"0":"")+date.getSeconds()},e:function(date){return"Not Yet Supported"},I:function(date){return"Not Supported"},O:function(date){return(-date.getTimezoneOffset()<0?"-":"+")+(Math.abs(date.getTimezoneOffset()/60)<10?"0":"")+(Math.abs(date.getTimezoneOffset()/60))+"00"},P:function(date){return(-date.getTimezoneOffset()<0?"-":"+")+(Math.abs(date.getTimezoneOffset()/60)<10?"0":"")+(Math.abs(date.getTimezoneOffset()/60))+":"+(Math.abs(date.getTimezoneOffset()%60)<10?"0":"")+(Math.abs(date.getTimezoneOffset()%60))},T:function(date){var m=date.getMonth();date.setMonth(0);var result=date.toTimeString().replace(/^.+ \(?([^\)]+)\)?$/,"$1");date.setMonth(m);return result},Z:function(date){return -date.getTimezoneOffset()*60},c:function(date){return date.format("Y-m-d")+"T"+date.format("H:i:sP")},r:function(date){return date.toString()},U:function(date){return date.getTime()/1000}};return{format:function(oDate){var out="";for(var i=0;i<fmt.length;i++){var c=fmt.charAt(i);if(replaceChars[c]){out+=replaceChars[c].call(oDate)}else{out+=c}}return out}}};DateFormat.getDateInstance=function(){return new DateFormat("M/d/y h:i a")}}$namespace("org.owasp.esapi");org.owasp.esapi.ESAPI=function(oProperties){var _properties=oProperties;if(!_properties){throw new RuntimeException("Configuration Error - Unable to load $ESAPI_Properties Object")}var _encoder=null;var _validator=null;var _logFactory=null;var _resourceBundle=null;var _httputilities=null;return{properties:_properties,encoder:function(){if(!_encoder){if(!_properties.encoder.Implementation){throw new RuntimeException("Configuration Error - $ESAPI.properties.encoder.Implementation object not found.")}_encoder=new _properties.encoder.Implementation()}return _encoder},validator:function(){if(!_validator){if(!_properties.validation.Implementation){throw new RuntimeException("Configuration Error - $ESAPI.properties.validation.Implementation object not found.")}_validator=new _properties.validation.Implementation()}return _validator},httpUtilities:function(){if(!_httputilities){_httputilities=new org.owasp.esapi.HTTPUtilities()}return _httputilities}}};var $ESAPI=null;org.owasp.esapi.ESAPI.initialize=function(){$ESAPI=new org.owasp.esapi.ESAPI(Base.esapi.properties)};$namespace("org.owasp.esapi");org.owasp.esapi.Encoder=function(){};$namespace("org.owasp.esapi");org.owasp.esapi.EncoderConstants={CHAR_LOWERS:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],CHAR_UPPERS:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],CHAR_DIGITS:["0","1","2","3","4","5","6","7","8","9"],CHAR_SPECIALS:["!","$","*","+","-",".","=","?","@","^","_","|","~"],CHAR_LETTERS:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],CHAR_ALNUM:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9"]};$namespace("org.owasp.esapi");org.owasp.esapi.EnterpriseSecurityException=function(sUserMessage,sLogMessage,oException){var _logMessage=sLogMessage;var _super=new Exception(sUserMessage,oException);return{getMessage:_super.getMessage,getUserMessage:_super.getMessage,getLogMessage:function(){return _logMessage},getStackTrace:_super.getStackTrace,printStackTrace:_super.printStackTrace}};$namespace("org.owasp.esapi");org.owasp.esapi.HTTPUtilities=function(){return{addCookie:function(oCookie){$type(oCookie,org.owasp.esapi.net.Cookie);if(window.top.location.protocol!="http:"&&window.top.location.protocol!="https:"){throw new RuntimeException(resourceBundle.getString("HTTPUtilities.Cookie.Protocol",{protocol:window.top.location.protocol}))}var name=oCookie.getName(),value=oCookie.getValue(),maxAge=oCookie.getMaxAge(),domain=oCookie.getDomain(),path=oCookie.getPath(),secure=oCookie.getSecure();var validationErrors=new org.owasp.esapi.ValidationErrorList();var cookieName=$ESAPI.validator().getValidInput("cookie name",name,"HttpCookieName",50,false,validationErrors);var cookieValue=$ESAPI.validator().getValidInput("cookie value",value,"HttpCookieValue",5000,false,validationErrors);if(validationErrors.size()==0){var header=name+"="+escape(value);header+=maxAge?";expires="+(new Date((new Date()).getTime()+(1000*maxAge)).toGMTString()):"";header+=path?";path="+path:"";header+=domain?";domain="+domain:"";document.cookie=header}else{console.log(EventType.SECURITY_FAILURE,resourceBundle.getString("HTTPUtilities.Cookie.UnsafeData",{name:name,value:value}))}},getCookie:function(sName){var cookieJar=document.cookie.split("; ");for(var i=0,len=cookieJar.length;i<len;i++){var cookie=cookieJar[i].split("=");if(cookie[0]==escape(sName)){return new org.owasp.esapi.net.Cookie(sName,cookie[1]?unescape(cookie[1]):"")}}return null},killAllCookies:function(){var cookieJar=document.cookie.split("; ");for(var i=0,len=cookieJar.length;i<len;i++){var cookie=cookieJar[i].split("=");var name=unescape(cookie[0]);if(name!==""){if(!this.killCookie(name)){throw new RuntimeException("HTTPUtilities.Cookie.CantKill",{name:name})}}}return true},killCookie:function(sName){var c=this.getCookie(sName);if(c){c.setMaxAge(-10);this.addCookie(c);if(this.getCookie(sName)){throw new RuntimeException("HTTPUtilities.Cookie.CantKill",{name:sName})}return true}return false},getRequestParameter:function(sName){var url=window.top.location.search.substring(1);var pIndex=url.indexOf(sName);if(pIndex<0){return null}pIndex=pIndex+sName.length;var lastIndex=url.indexOf("&",pIndex);if(lastIndex<0){lastIndex=url.length}return unescape(url.substring(pIndex,lastIndex))}}};$namespace("org.owasp.esapi");org.owasp.esapi.IntrusionException=function(sUserMessage,sLogMessage,oCause){var _super=new org.owasp.esapi.EnterpriseSecurityException(sUserMessage,sLogMessage,oCause);return{getMessage:_super.getMessage,getUserMessage:_super.getMessage,getLogMessage:_super.getLogMessage,getStackTrace:_super.getStackTrace,printStackTrace:_super.printStackTrace}};$namespace("org.owasp.esapi");org.owasp.esapi.LogFactory=function(){return{getLogger:false}};$namespace("org.owasp.esapi");org.owasp.esapi.Logger=function(){return{setLevel:false,fatal:false,error:false,isErrorEnabled:false,warning:false,isWarningEnabled:false,info:false,isInfoEnabled:false,debug:false,isDebugEnabled:false,trace:false,isTraceEnabled:false}};org.owasp.esapi.Logger.EventType=function(sName,bNewSuccess){var type=sName;var success=bNewSuccess;return{isSuccess:function(){return success},toString:function(){return type}}};with(org.owasp.esapi.Logger){EventType.SECURITY_SUCCESS=new EventType("SECURITY SUCCESS",true);EventType.SECURITY_FAILURE=new EventType("SECURITY FAILURE",false);EventType.EVENT_SUCCESS=new EventType("EVENT SUCCESS",true);EventType.EVENT_FAILURE=new EventType("EVENT FAILURE",false);OFF=Number.MAX_VALUE;FATAL=1000;ERROR=800;WARNING=600;INFO=400;DEBUG=200;TRACE=100;ALL=Number.MIN_VALUE}$namespace("org.owasp.esapi");org.owasp.esapi.PreparedString=function(sTemplate,oCodec,sParameterCharacter){var parts=[];var parameters=[];function split(s){var idx=0,pcount=0;for(var i=0;i<s.length;i++){if(s.charAt(i)==sParameterCharacter){pcount++;parts.push(s.substr(idx,i));idx=i+1}}parts.push(s.substr(idx));parameters=new Array(pcount)}if(!sParameterCharacter){sParameterCharacter="?"}split(sTemplate);return{set:function(iIndex,sValue,codec){if(iIndex<1||iIndex>parameters.length){throw new IllegalArgumentException("Attempt to set parameter: "+iIndex+" on a PreparedString with only "+parameters.length+" placeholders")}if(!codec){codec=oCodec}parameters[iIndex-1]=codec.encode([],sValue)},toString:function(){for(var ix=0;ix<parameters.length;ix++){if(parameters[ix]==null){throw new RuntimeException("Attempt to render PreparedString without setting parameter "+(ix+1))}}var out="",i=0;for(var p=0;p<parts.length;p++){out+=parts[p];if(i<parameters.length){out+=parameters[i++]}}return out}}};$namespace("org.owasp.esapi");org.owasp.esapi.ValidationErrorList=function(){var errorList=Array();return{addError:function(sContext,oValidationException){if(sContext==null){throw new RuntimeException("Context cannot be null: "+oValidationException.getLogMessage(),oValidationException)}if(oValidationException==null){throw new RuntimeException("Context ("+sContext+") - Error cannot be null")}if(errorList[sContext]){throw new RuntimeException("Context ("+sContext+") already exists. must be unique.")}errorList[sContext]=oValidationException},errors:function(){return errorList},isEmpty:function(){return errorList.length==0},size:function(){return errorList.length}}};$namespace("org.owasp.esapi");org.owasp.esapi.ValidationRule=function(){return{getValid:false,setAllowNull:false,getTypeName:false,setTypeName:false,setEncoder:false,assertValid:false,getSafe:false,isValid:false,whitelist:false}};$namespace("org.owasp.esapi");org.owasp.esapi.Validator=function(){return{addRule:false,getRule:false,getValidInput:false,isValidDate:false,getValidDate:false,isValidSafeHTML:false,getValidSafeHTML:false,isValidCreditCard:false,getValidCreditCard:false,isValidFilename:false,getValidFilename:false,isValidNumber:false,getValidNumber:false,isValidPrintable:false,getValidPrintable:false}};$namespace("org.owasp.esapi.codecs.Base64");org.owasp.esapi.codecs.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(sInput){if(!sInput){return null}var out="";var ch1,ch2,ch3,enc1,enc2,enc3,enc4;var i=0;var input=org.owasp.esapi.codecs.UTF8.encode(sInput);while(i<input.length){ch1=input.charCodeAt(i++);ch2=input.charCodeAt(i++);ch3=input.charCodeAt(i++);enc1=ch1>>2;enc2=((ch1&3)<<4)|(ch2>>4);enc3=((ch2&15)<<2)|(ch3>>6);enc4=ch3&63;if(isNaN(ch2)){enc3=enc4=64}else{if(isNaN(ch3)){enc4=64}}out+=this._keyStr.charAt(enc1)+this._keyStr.charAt(enc2)+this._keyStr.charAt(enc3)+this._keyStr.charAt(enc4)}return out},decode:function(sInput){if(!sInput){return null}var out="";var ch1,ch2,ch3,enc1,enc2,enc3,enc4;var i=0;var input=sInput.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(i<input.length){enc1=this._keyStr.indexOf(input.charAt(i++));enc2=this._keyStr.indexOf(input.charAt(i++));enc3=this._keyStr.indexOf(input.charAt(i++));enc4=this._keyStr.indexOf(input.charAt(i++));ch1=(enc1<<2)|(enc2>>4);ch2=((enc2&15)<<4)|(enc3>>2);ch3=((enc3&3)<<6)|enc4;out+=String.fromCharCode(ch1);if(enc3!=64){out+=String.fromCharCode(ch2)}if(enc4!=64){out+=String.fromCharCode(ch3)}}out=org.owasp.esapi.codecs.UTF8.decode(out);return out}};$namespace("org.owasp.esapi.codecs");org.owasp.esapi.codecs.CSSCodec=function(){var _super=new org.owasp.esapi.codecs.Codec();return{encode:_super.encode,decode:_super.decode,encodeCharacter:function(aImmune,c){if(aImmune.indexOf(c)>-1){return c}var hex=org.owasp.esapi.codecs.Codec.getHexForNonAlphanumeric(c);if(hex==null){return c}return"\\"+hex+" "},decodeCharacter:function(oPushbackString){oPushbackString.mark();var first=oPushbackString.next();if(first==null){oPushbackString.reset();return null}if(first!="\\"){oPushbackString.reset();return null}var second=oPushbackString.next();if(second==null){oPushbackString.reset();return null}if(oPushbackString.isHexDigit(second)){var out=second;for(var i=0;i<6;i++){var c=oPushbackString.next();if(c==null||c.charCodeAt(0)==32){break}if(oPushbackString.isHexDigit(c)){out+=c}else{input.pushback(c);break}}try{var n=parseInt(out,16);return String.fromCharCode(n)}catch(e){oPushbackString.reset();return null}}return second}}};$namespace("org.owasp.esapi.codecs");org.owasp.esapi.codecs.Codec=function(){return{encode:function(aImmune,sInput){var out="";for(var i=0;i<sInput.length;i++){var c=sInput.charAt(i);out+=this.encodeCharacter(aImmune,c)}return out},encodeCharacter:function(aImmune,c){return c},decode:function(sInput){var out="";var pbs=new org.owasp.esapi.codecs.PushbackString(sInput);while(pbs.hasNext()){var c=this.decodeCharacter(pbs);if(c!=null){out+=c}else{out+=pbs.next()}}return out},decodeCharacter:function(oPushbackString){return oPushbackString.next()}}};org.owasp.esapi.codecs.Codec.getHexForNonAlphanumeric=function(c){if(c.charCodeAt(0)<256){return org.owasp.esapi.codecs.Codec.hex[c.charCodeAt(0)]}return c.charCodeAt(0).toString(16)};org.owasp.esapi.codecs.Codec.hex=[];for(var c=0;c<255;c++){if(c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122){org.owasp.esapi.codecs.Codec.hex[c]=null}else{org.owasp.esapi.codecs.Codec.hex[c]=c.toString(16)}}var entityToCharacterMap=[];entityToCharacterMap["&quot"]="34";entityToCharacterMap["&amp"]="38";entityToCharacterMap["&lt"]="60";entityToCharacterMap["&gt"]="62";entityToCharacterMap["&nbsp"]="160";entityToCharacterMap["&iexcl"]="161";entityToCharacterMap["&cent"]="162";entityToCharacterMap["&pound"]="163";entityToCharacterMap["&curren"]="164";entityToCharacterMap["&yen"]="165";entityToCharacterMap["&brvbar"]="166";entityToCharacterMap["&sect"]="167";entityToCharacterMap["&uml"]="168";entityToCharacterMap["&copy"]="169";entityToCharacterMap["&ordf"]="170";entityToCharacterMap["&laquo"]="171";entityToCharacterMap["&not"]="172";entityToCharacterMap["&shy"]="173";entityToCharacterMap["&reg"]="174";entityToCharacterMap["&macr"]="175";entityToCharacterMap["&deg"]="176";entityToCharacterMap["&plusmn"]="177";entityToCharacterMap["&sup2"]="178";entityToCharacterMap["&sup3"]="179";entityToCharacterMap["&acute"]="180";entityToCharacterMap["&micro"]="181";entityToCharacterMap["&para"]="182";entityToCharacterMap["&middot"]="183";entityToCharacterMap["&cedil"]="184";entityToCharacterMap["&sup1"]="185";entityToCharacterMap["&ordm"]="186";entityToCharacterMap["&raquo"]="187";entityToCharacterMap["&frac14"]="188";entityToCharacterMap["&frac12"]="189";entityToCharacterMap["&frac34"]="190";entityToCharacterMap["&iquest"]="191";entityToCharacterMap["&Agrave"]="192";entityToCharacterMap["&Aacute"]="193";entityToCharacterMap["&Acirc"]="194";entityToCharacterMap["&Atilde"]="195";entityToCharacterMap["&Auml"]="196";entityToCharacterMap["&Aring"]="197";entityToCharacterMap["&AElig"]="198";entityToCharacterMap["&Ccedil"]="199";entityToCharacterMap["&Egrave"]="200";entityToCharacterMap["&Eacute"]="201";entityToCharacterMap["&Ecirc"]="202";entityToCharacterMap["&Euml"]="203";entityToCharacterMap["&Igrave"]="204";entityToCharacterMap["&Iacute"]="205";entityToCharacterMap["&Icirc"]="206";entityToCharacterMap["&Iuml"]="207";entityToCharacterMap["&ETH"]="208";entityToCharacterMap["&Ntilde"]="209";entityToCharacterMap["&Ograve"]="210";entityToCharacterMap["&Oacute"]="211";entityToCharacterMap["&Ocirc"]="212";entityToCharacterMap["&Otilde"]="213";entityToCharacterMap["&Ouml"]="214";entityToCharacterMap["&times"]="215";entityToCharacterMap["&Oslash"]="216";entityToCharacterMap["&Ugrave"]="217";entityToCharacterMap["&Uacute"]="218";entityToCharacterMap["&Ucirc"]="219";entityToCharacterMap["&Uuml"]="220";entityToCharacterMap["&Yacute"]="221";entityToCharacterMap["&THORN"]="222";entityToCharacterMap["&szlig"]="223";entityToCharacterMap["&agrave"]="224";entityToCharacterMap["&aacute"]="225";entityToCharacterMap["&acirc"]="226";entityToCharacterMap["&atilde"]="227";entityToCharacterMap["&auml"]="228";entityToCharacterMap["&aring"]="229";entityToCharacterMap["&aelig"]="230";entityToCharacterMap["&ccedil"]="231";entityToCharacterMap["&egrave"]="232";entityToCharacterMap["&eacute"]="233";entityToCharacterMap["&ecirc"]="234";entityToCharacterMap["&euml"]="235";entityToCharacterMap["&igrave"]="236";entityToCharacterMap["&iacute"]="237";entityToCharacterMap["&icirc"]="238";entityToCharacterMap["&iuml"]="239";entityToCharacterMap["&eth"]="240";entityToCharacterMap["&ntilde"]="241";entityToCharacterMap["&ograve"]="242";entityToCharacterMap["&oacute"]="243";entityToCharacterMap["&ocirc"]="244";entityToCharacterMap["&otilde"]="245";entityToCharacterMap["&ouml"]="246";entityToCharacterMap["&divide"]="247";entityToCharacterMap["&oslash"]="248";entityToCharacterMap["&ugrave"]="249";entityToCharacterMap["&uacute"]="250";entityToCharacterMap["&ucirc"]="251";entityToCharacterMap["&uuml"]="252";entityToCharacterMap["&yacute"]="253";entityToCharacterMap["&thorn"]="254";entityToCharacterMap["&yuml"]="255";entityToCharacterMap["&OElig"]="338";entityToCharacterMap["&oelig"]="339";entityToCharacterMap["&Scaron"]="352";entityToCharacterMap["&scaron"]="353";entityToCharacterMap["&Yuml"]="376";entityToCharacterMap["&fnof"]="402";entityToCharacterMap["&circ"]="710";entityToCharacterMap["&tilde"]="732";entityToCharacterMap["&Alpha"]="913";entityToCharacterMap["&Beta"]="914";entityToCharacterMap["&Gamma"]="915";entityToCharacterMap["&Delta"]="916";entityToCharacterMap["&Epsilon"]="917";entityToCharacterMap["&Zeta"]="918";entityToCharacterMap["&Eta"]="919";entityToCharacterMap["&Theta"]="920";entityToCharacterMap["&Iota"]="921";entityToCharacterMap["&Kappa"]="922";entityToCharacterMap["&Lambda"]="923";entityToCharacterMap["&Mu"]="924";entityToCharacterMap["&Nu"]="925";entityToCharacterMap["&Xi"]="926";entityToCharacterMap["&Omicron"]="927";entityToCharacterMap["&Pi"]="928";entityToCharacterMap["&Rho"]="929";entityToCharacterMap["&Sigma"]="931";entityToCharacterMap["&Tau"]="932";entityToCharacterMap["&Upsilon"]="933";entityToCharacterMap["&Phi"]="934";entityToCharacterMap["&Chi"]="935";entityToCharacterMap["&Psi"]="936";entityToCharacterMap["&Omega"]="937";entityToCharacterMap["&alpha"]="945";entityToCharacterMap["&beta"]="946";entityToCharacterMap["&gamma"]="947";entityToCharacterMap["&delta"]="948";entityToCharacterMap["&epsilon"]="949";entityToCharacterMap["&zeta"]="950";entityToCharacterMap["&eta"]="951";entityToCharacterMap["&theta"]="952";entityToCharacterMap["&iota"]="953";entityToCharacterMap["&kappa"]="954";entityToCharacterMap["&lambda"]="955";entityToCharacterMap["&mu"]="956";entityToCharacterMap["&nu"]="957";entityToCharacterMap["&xi"]="958";entityToCharacterMap["&omicron"]="959";entityToCharacterMap["&pi"]="960";entityToCharacterMap["&rho"]="961";entityToCharacterMap["&sigmaf"]="962";entityToCharacterMap["&sigma"]="963";entityToCharacterMap["&tau"]="964";entityToCharacterMap["&upsilon"]="965";entityToCharacterMap["&phi"]="966";entityToCharacterMap["&chi"]="967";entityToCharacterMap["&psi"]="968";entityToCharacterMap["&omega"]="969";entityToCharacterMap["&thetasym"]="977";entityToCharacterMap["&upsih"]="978";entityToCharacterMap["&piv"]="982";entityToCharacterMap["&ensp"]="8194";entityToCharacterMap["&emsp"]="8195";entityToCharacterMap["&thinsp"]="8201";entityToCharacterMap["&zwnj"]="8204";entityToCharacterMap["&zwj"]="8205";entityToCharacterMap["&lrm"]="8206";entityToCharacterMap["&rlm"]="8207";entityToCharacterMap["&ndash"]="8211";entityToCharacterMap["&mdash"]="8212";entityToCharacterMap["&lsquo"]="8216";entityToCharacterMap["&rsquo"]="8217";entityToCharacterMap["&sbquo"]="8218";entityToCharacterMap["&ldquo"]="8220";entityToCharacterMap["&rdquo"]="8221";entityToCharacterMap["&bdquo"]="8222";entityToCharacterMap["&dagger"]="8224";entityToCharacterMap["&Dagger"]="8225";entityToCharacterMap["&bull"]="8226";entityToCharacterMap["&hellip"]="8230";entityToCharacterMap["&permil"]="8240";entityToCharacterMap["&prime"]="8242";entityToCharacterMap["&Prime"]="8243";entityToCharacterMap["&lsaquo"]="8249";entityToCharacterMap["&rsaquo"]="8250";entityToCharacterMap["&oline"]="8254";entityToCharacterMap["&frasl"]="8260";entityToCharacterMap["&euro"]="8364";entityToCharacterMap["&image"]="8365";entityToCharacterMap["&weierp"]="8472";entityToCharacterMap["&real"]="8476";entityToCharacterMap["&trade"]="8482";entityToCharacterMap["&alefsym"]="8501";entityToCharacterMap["&larr"]="8592";entityToCharacterMap["&uarr"]="8593";entityToCharacterMap["&rarr"]="8594";entityToCharacterMap["&darr"]="8595";entityToCharacterMap["&harr"]="8596";entityToCharacterMap["&crarr"]="8629";entityToCharacterMap["&lArr"]="8656";entityToCharacterMap["&uArr"]="8657";entityToCharacterMap["&rArr"]="8658";entityToCharacterMap["&dArr"]="8659";entityToCharacterMap["&hArr"]="8660";entityToCharacterMap["&forall"]="8704";entityToCharacterMap["&part"]="8706";entityToCharacterMap["&exist"]="8707";entityToCharacterMap["&empty"]="8709";entityToCharacterMap["&nabla"]="8711";entityToCharacterMap["&isin"]="8712";entityToCharacterMap["&notin"]="8713";entityToCharacterMap["&ni"]="8715";entityToCharacterMap["&prod"]="8719";entityToCharacterMap["&sum"]="8721";entityToCharacterMap["&minus"]="8722";entityToCharacterMap["&lowast"]="8727";entityToCharacterMap["&radic"]="8730";entityToCharacterMap["&prop"]="8733";entityToCharacterMap["&infin"]="8734";entityToCharacterMap["&ang"]="8736";entityToCharacterMap["&and"]="8743";entityToCharacterMap["&or"]="8744";entityToCharacterMap["&cap"]="8745";entityToCharacterMap["&cup"]="8746";entityToCharacterMap["&int"]="8747";entityToCharacterMap["&there4"]="8756";entityToCharacterMap["&sim"]="8764";entityToCharacterMap["&cong"]="8773";entityToCharacterMap["&asymp"]="8776";entityToCharacterMap["&ne"]="8800";entityToCharacterMap["&equiv"]="8801";entityToCharacterMap["&le"]="8804";entityToCharacterMap["&ge"]="8805";entityToCharacterMap["&sub"]="8834";entityToCharacterMap["&sup"]="8835";entityToCharacterMap["&nsub"]="8836";entityToCharacterMap["&sube"]="8838";entityToCharacterMap["&supe"]="8839";entityToCharacterMap["&oplus"]="8853";entityToCharacterMap["&otimes"]="8855";entityToCharacterMap["&perp"]="8869";entityToCharacterMap["&sdot"]="8901";entityToCharacterMap["&lceil"]="8968";entityToCharacterMap["&rceil"]="8969";entityToCharacterMap["&lfloor"]="8970";entityToCharacterMap["&rfloor"]="8971";entityToCharacterMap["&lang"]="9001";entityToCharacterMap["&rang"]="9002";entityToCharacterMap["&loz"]="9674";entityToCharacterMap["&spades"]="9824";entityToCharacterMap["&clubs"]="9827";entityToCharacterMap["&hearts"]="9829";entityToCharacterMap["&diams"]="9830";var characterToEntityMap=[];for(var entity in entityToCharacterMap){characterToEntityMap[entityToCharacterMap[entity]]=entity}$namespace("org.owasp.esapi.codecs");org.owasp.esapi.codecs.HTMLEntityCodec=function(){var _super=new org.owasp.esapi.codecs.Codec();var getNumericEntity=function(input){var first=input.peek();if(first==null){return null}if(first=="x"||first=="X"){input.next();return parseHex(input)}return parseNumber(input)};var parseNumber=function(input){var out="";while(input.hasNext()){var c=input.peek();if(c.match(/[0-9]/)){out+=c;input.next()}else{if(c==";"){input.next();break}else{break}}}try{return parseInt(out)}catch(e){return null}};var parseHex=function(input){var out="";while(input.hasNext()){var c=input.peek();if(c.match(/[0-9A-Fa-f]/)){out+=c;input.next()}else{if(c==";"){input.next();break}else{break}}}try{return parseInt(out,16)}catch(e){return null}};var getNamedEntity=function(input){var entity="";while(input.hasNext()){var c=input.peek();if(c.match(/[A-Za-z]/)){entity+=c;input.next();if(entityToCharacterMap.containsKey("&"+entity)){if(input.peek(";")){input.next()}break}}else{if(c==";"){input.next()}else{break}}}return String.fromCharCode(entityToCharacterMap.getCaseInsensitive("&"+entity))};return{encode:_super.encode,decode:_super.decode,encodeCharacter:function(aImmune,c){if(aImmune.indexOf(c)>-1){return c}var hex=org.owasp.esapi.codecs.Codec.getHexForNonAlphanumeric(c);if(hex==null){return c}var cc=c.charCodeAt(0);if((cc<=31&&c!="\t"&&c!="\n"&&c!="\r")||(cc>=127&&cc<=159)||c==" "){return" "}var entityName=characterToEntityMap[cc];if(entityName!=null){return entityName+";"}return"&#x"+hex+";"},decodeCharacter:function(oPushbackString){var input=oPushbackString;input.mark();var first=input.next();if(first==null||first!="&"){input.reset();return null}var second=input.next();if(second==null){input.reset();return null}if(second=="#"){var c=getNumericEntity(input);if(c!=null){return c}}else{if(second.match(/[A-Za-z]/)){input.pushback(second);c=getNamedEntity(input);if(c!=null){return c}}}input.reset();return null}}};$namespace("org.owasp.esapi.codecs");org.owasp.esapi.codecs.JavascriptCodec=function(){var _super=new org.owasp.esapi.codecs.Codec();return{encode:function(aImmune,sInput){var out="";for(var idx=0;idx<sInput.length;idx++){var ch=sInput.charAt(idx);if(aImmune.indexOf(ch)>-1){out+=ch}else{var hex=org.owasp.esapi.codecs.Codec.getHexForNonAlphanumeric(ch);if(hex==null){out+=ch}else{var tmp=ch.charCodeAt(0).toString(16);if(ch.charCodeAt(0)<256){var pad="00".substr(tmp.length);out+="\\x"+pad+tmp.toUpperCase()}else{pad="0000".substr(tmp.length);out+="\\u"+pad+tmp.toUpperCase()}}}}return out},decode:_super.decode,decodeCharacter:function(oPushbackString){oPushbackString.mark();var first=oPushbackString.next();if(first==null){oPushbackString.reset();return null}if(first!="\\"){oPushbackString.reset();return null}var second=oPushbackString.next();if(second==null){oPushbackString.reset();return null}if(second=="b"){return 8}else{if(second=="t"){return 9}else{if(second=="n"){return 10}else{if(second=="v"){return 11}else{if(second=="f"){return 12}else{if(second=="r"){return 13}else{if(second=='"'){return 34}else{if(second=="'"){return 39}else{if(second=="\\"){return 92}else{if(second.toLowerCase()=="x"){out="";for(var i=0;i<2;i++){var c=oPushbackString.nextHex();if(c!=null){out+=c}else{input.reset();return null}}try{n=parseInt(out,16);return String.fromCharCode(n)}catch(e){oPushbackString.reset();return null}}else{if(second.toLowerCase()=="u"){out="";for(i=0;i<4;i++){c=oPushbackString.nextHex();if(c!=null){out+=c}else{input.reset();return null}}try{var n=parseInt(out,16);return String.fromCharCode(n)}catch(e){oPushbackString.reset();return null}}else{if(oPushbackString.isOctalDigit(second)){var out=second;var c2=oPushbackString.next();if(!oPushbackString.isOctalDigit(c2)){oPushbackString.pushback(c2)}else{out+=c2;var c3=oPushbackString.next();if(!oPushbackString.isOctalDigit(c3)){oPushbackString.pushback(c3)}else{out+=c3}}try{n=parseInt(out,8);return String.fromCharCode(n)}catch(e){oPushbackString.reset();return null}}}}}}}}}}}}}return second}}};$namespace("org.owasp.esapi.codecs");org.owasp.esapi.codecs.PercentCodec=function(){var _super=new org.owasp.esapi.codecs.Codec();var ALPHA_NUMERIC_STR="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";var RFC_NON_ALPHANUMERIC_UNRESERVED_STR="-._~";var ENCODED_NON_ALPHA_NUMERIC_UNRESERVED=true;var UNENCODED_STR=ALPHA_NUMERIC_STR+(ENCODED_NON_ALPHA_NUMERIC_UNRESERVED?"":RFC_NON_ALPHANUMERIC_UNRESERVED_STR);var getTwoUpperBytes=function(b){var out="";if(b<-128||b>127){throw new IllegalArgumentException("b is not a byte (was "+b+")")}b&=255;if(b<16){out+="0"}return out+b.toString(16).toUpperCase()};return{encode:_super.encode,decode:_super.decode,encodeCharacter:function(aImmune,c){if(UNENCODED_STR.indexOf(c)>-1){return c}var bytes=org.owasp.esapi.codecs.UTF8.encode(c);var out="";for(var b=0;b<bytes.length;b++){out+="%"+getTwoUpperBytes(bytes.charCodeAt(b))}return out},decodeCharacter:function(oPushbackString){oPushbackString.mark();var first=oPushbackString.next();if(first==null||first!="%"){oPushbackString.reset();return null}var out="";for(var i=0;i<2;i++){var c=oPushbackString.nextHex();if(c!=null){out+=c}}if(out.length==2){try{var n=parseInt(out,16);return String.fromCharCode(n)}catch(e){}}oPushbackString.reset();return null}}};$namespace("org.owasp.esapi.codecs");org.owasp.esapi.codecs.PushbackString=function(sInput){var _input=sInput,_pushback="",_temp="",_index=0,_mark=0;return{pushback:function(c){_pushback=c},index:function(){return _index},hasNext:function(){if(_pushback!=null){return true}return !(_input==null||_input.length==0||_index>=_input.length)},next:function(){if(_pushback!=null){var save=_pushback;_pushback=null;return save}if(_input==null||_input.length==0||_index>=_input.length){return null}return _input.charAt(_index++)},nextHex:function(){var c=this.next();if(this.isHexDigit(c)){return c}return null},nextOctal:function(){var c=this.next();if(this.isOctalDigit(c)){return c}return null},isHexDigit:function(c){return c!=null&&((c>="0"&&c<="9")||(c>="a"&&c<="f")||(c>="A"&&c<="F"))},isOctalDigit:function(c){return c!=null&&(c>="0"&&c<="7")},peek:function(c){if(!c){if(_pushback!=null){return _pushback}if(_input==null||_input.length==0||_index>=_input.length){return null}return _input.charAt(_index)}else{if(_pushback!=null&&_pushback==c){return true}if(_input==null||_input.length==0||_index>=_input.length){return false}return _input.charAt(_index)==c}},mark:function(){_temp=_pushback;_mark=_index},reset:function(){_pushback=_temp;_index=_mark},remainder:function(){var out=_input.substr(_index);if(_pushback!=null){out=_pushback+out}return out}}};$namespace("org.owasp.esapi.codecs");org.owasp.esapi.codecs.UTF8={encode:function(sInput){var input=sInput.replace(/\r\n/g,"\n");var utftext="";for(var n=0;n<input.length;n++){var c=input.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c)}else{if((c>127)&&(c<2048)){utftext+=String.fromCharCode((c>>6)|192);utftext+=String.fromCharCode((c&63)|128)}else{utftext+=String.fromCharCode((c>>12)|224);utftext+=String.fromCharCode(((c>>6)&63)|128);utftext+=String.fromCharCode((c&63)|128)}}}return utftext},decode:function(sInput){var out="";var i=c=c1=c2=0;while(i<sInput.length){c=sInput.charCodeAt(i);if(c<128){out+=String.fromCharCode(c);i++}else{if((c>191)&&(c<224)){c2=sInput.charCodeAt(i+1);out+=String.fromCharCode(((c&31)<<6)|(c2&63));i+=2}else{c2=utftext.charCodeAt(i+1);c3=utftext.charCodeAt(i+2);string+=String.fromCharCode(((c&15)<<12)|((c2&63)<<6)|(c3&63));i+=3}}}return out}};$namespace("org.owasp.esapi.i18n");org.owasp.esapi.i18n.ArrayResourceBundle=function(sName,oLocale,aMessages,oParent){with(org.owasp.esapi.i18n){var _super=new ResourceBundle(sName,oLocale,oParent)}var messages=aMessages;return{getParent:_super.getParent,getLocale:_super.getLocale,getName:_super.getName,getString:_super.getString,getMessage:function(sKey){return messages[sKey]}}};$namespace("org.owasp.esapi.i18n");org.owasp.esapi.i18n.Locale=function(sLanguage,sCountry,sVariant){var language=sLanguage,country=sCountry,variant=sVariant;return{getLanguage:function(){return language},getCountry:function(){return country},getVariant:function(){return variant},toString:function(){return language+(country?"-"+country+(variant?"-"+variant:""):"")}}};org.owasp.esapi.i18n.Locale.US=new org.owasp.esapi.i18n.Locale("en","US");org.owasp.esapi.i18n.Locale.GB=new org.owasp.esapi.i18n.Locale("en","GB");org.owasp.esapi.i18n.Locale.getLocale=function(sLocale){var l=sLocale.split("-");return new org.owasp.esapi.i18n.Locale(l[0],(l.length>1?l[1]:""),(l.length>2?l.length[2]:""))};org.owasp.esapi.i18n.Locale.getDefault=function(){var l=(navigator.language?navigator.language:(navigator.userLanguage?navigator.userLanguage:"en-US")).split("-");return new org.owasp.esapi.i18n.Locale(l[0],(l.length>1?l[1]:""),(l.length>2?l.length[2]:""))};$namespace("org.owasp.esapi.i18n");org.owasp.esapi.i18n.ObjectResourceBundle=function(oResource,oParent){var _super=new org.owasp.esapi.i18n.ResourceBundle(oResource.name,org.owasp.esapi.i18n.Locale.getLocale(oResource.locale),oParent);var messages=oResource.messages;return{getParent:_super.getParent,getLocale:_super.getLocale,getName:_super.getName,getString:_super.getString,getMessage:function(sKey){return messages[sKey]}}};$namespace("org.owasp.esapi.i18n");org.owasp.esapi.i18n.ResourceBundle=function(sName,oLocale,oParentResourceBundle){var parent=oParentResourceBundle;var locale=oLocale;var name=sName;if(!name){throw new SyntaxError("Name required for implementations of org.owasp.esapi.i18n.ResourceBundle")}if(!locale){throw new SyntaxError("Locale required for implementations of org.owasp.esapi.i18n.ResourceBundle")}return{getParent:function(){return parent},getLocale:function(){return locale},getName:function(){return name},getMessage:function(sKey){return sKey},getString:function(sKey,oContextMap){if(arguments.length<1){throw new IllegalArgumentException("No key passed to getString")}var msg=this.getMessage(sKey);if(!msg){if(parent){return parent.getString(sKey,oContextMap)}else{return sKey}}if(!msg.match(/\{([A-Za-z]+)\}/)||!oContextMap){return msg}var out="",lastIndex=0;while(true){var nextVarIdx=msg.indexOf("{",lastIndex);var endIndex=msg.indexOf("}",nextVarIdx);if(nextVarIdx<0){out+=msg.substr(lastIndex,msg.length-lastIndex);break}if(nextVarIdx>=0&&endIndex<-1){throw new SyntaxError("Invalid Message - Unclosed Context Reference: "+msg)}out+=msg.substring(lastIndex,nextVarIdx);var contextKey=msg.substring(nextVarIdx+1,endIndex);if(oContextMap[contextKey]){out+=oContextMap[contextKey]}else{out+=msg.substring(nextVarIdx,endIndex+1)}lastIndex=endIndex+1}return out}}};org.owasp.esapi.i18n.ResourceBundle.getResourceBundle=function(sResource,oLocale){var classname=sResource+"_"+oLocale.toString().replace("-","_");with(org.owasp.esapi.i18n){if(ResourceBundle[classname] instanceof Object){return ResourceBundle[classname]}else{return new ResourceBundle[classname]()}}};$namespace("org.owasp.esapi.net");org.owasp.esapi.net.Cookie=function(sName,sValue){var name;var value;var comment;var domain;var maxAge;var path;var secure;var version;var tSpecials=",; ";var isToken=function(sValue){for(var i=0,len=sValue.length;i<len;i++){var cc=sValue.charCodeAt(i),c=sValue.charAt(i);if(cc<32||cc>=127||tSpecials.indexOf(c)!=-1){return false}}return true};if(!isToken(sName)||sName.toLowerCase()=="comment"||sName.toLowerCase()=="discard"||sName.toLowerCase()=="domain"||sName.toLowerCase()=="expires"||sName.toLowerCase()=="max-age"||sName.toLowerCase()=="path"||sName.toLowerCase()=="secure"||sName.toLowerCase()=="version"||sName.charAt(0)=="$"){var errMsg=_resourceBundle.getString("Cookie.Name",{name:sName});throw new IllegalArgumentException(errMsg)}name=sName;value=sValue;return{setComment:function(purpose){comment=purpose},getComment:function(){return comment},setDomain:function(sDomain){domain=sDomain.toLowerCase()},getDomain:function(){return domain},setMaxAge:function(nExpirey){maxAge=nExpirey},getMaxAge:function(){return maxAge},setPath:function(sPath){path=sPath},getPath:function(){return path},setSecure:function(bSecure){secure=bSecure},getSecure:function(){return secure},getName:function(){return name},setValue:function(sValue){value=sValue},getValue:function(){return value},setVersion:function(nVersion){if(nVersion<0||nVersion>1){throw new IllegalArgumentException(_resourceBundle.getString("Cookie.Version",{version:nVersion}))}version=nVersion},getVersion:function(){return version}}};$namespace("org.owasp.esapi.reference.encoding");org.owasp.esapi.reference.encoding.DefaultEncoder=function(aCodecs){var _codecs=[],_htmlCodec=new org.owasp.esapi.codecs.HTMLEntityCodec(),_javascriptCodec=new org.owasp.esapi.codecs.JavascriptCodec(),_cssCodec=new org.owasp.esapi.codecs.CSSCodec(),_percentCodec=new org.owasp.esapi.codecs.PercentCodec();if(!aCodecs){_codecs.push(_htmlCodec);_codecs.push(_javascriptCodec);_codecs.push(_cssCodec);_codecs.push(_percentCodec)}else{_codecs=aCodecs}var IMMUNE_HTML=new Array(",",".","-","_"," ");var IMMUNE_HTMLATTR=new Array(",",".","-","_");var IMMUNE_CSS=new Array();var IMMUNE_JAVASCRIPT=new Array(",",".","_");return{cananicalize:function(sInput,bStrict){if(!sInput){return null}var working=sInput,codecFound=null,mixedCount=1,foundCount=0,clean=false;while(!clean){clean=true;_codecs.each(function(codec){var old=working;working=codec.decode(working);if(old!=working){if(codecFound!=null&&codecFound!=codec){mixedCount++}codecFound=codec;if(clean){foundCount++}clean=false}})}if(foundCount>=2&&mixedCount>1){if(bStrict){throw new org.owasp.esapi.IntrusionException("Input validation failure","Multiple ("+foundCount+"x) and mixed encoding ("+mixedCount+"x) detected in "+sInput)}}else{if(foundCount>=2){if(bStrict){throw new org.owasp.esapi.IntrusionException("Input validation failure","Multiple ("+foundCount+"x) encoding detected in "+sInput)}}else{if(mixedCount>1){if(bStrict){throw new org.owasp.esapi.IntrusionException("Input validation failure","Mixed ("+mixedCount+"x) encoding detected in "+sInput)}}}}return working},normalize:function(sInput){return sInput.replace(/[^\x00-\x7F]/g,"")},encodeForHTML:function(sInput){return !sInput?null:_htmlCodec.encode(IMMUNE_HTML,sInput)},decodeForHTML:function(sInput){return !sInput?null:_htmlCodec.decode(sInput)},encodeForHTMLAttribute:function(sInput){return !sInput?null:_htmlCodec.encode(IMMUNE_HTMLATTR,sInput)},encodeForCSS:function(sInput){return !sInput?null:_cssCodec.encode(IMMUNE_CSS,sInput)},encodeForJavaScript:function(sInput){return !sInput?null:_javascriptCodec.encode(IMMUNE_JAVASCRIPT,sInput)},encodeForJavascript:this.encodeForJavaScript,encodeForURL:function(sInput){return !sInput?null:escape(sInput)},decodeFromURL:function(sInput){return !sInput?null:unescape(sInput)},encodeForBase64:function(sInput){return !sInput?null:org.owasp.esapi.codecs.Base64.encode(sInput)},decodeFromBase64:function(sInput){return !sInput?null:org.owasp.esapi.codecs.Base64.decode(sInput)}}};$namespace("org.owasp.esapi.reference.logging");org.owasp.esapi.reference.logging.Log4JSLogFactory=function(){var loggersMap=Array();var Log4JSLogger=function(sModuleName){var jsLogger=null;var moduleName=sModuleName?sModuleName:null;var Level=Log4js.Level;var logUrl=false,logApplicationName=false,encodingRequired=false,encodingFunction=$ESAPI.encoder().encodeForHTML;jsLogger=Log4js.getLogger(moduleName);var convertESAPILevel=function(nLevel){var Logger=org.owasp.esapi.Logger;switch(nLevel){case Logger.OFF:return Log4js.Level.OFF;case Logger.FATAL:return Log4js.Level.FATAL;case Logger.ERROR:return Log4js.Level.ERROR;case Logger.WARNING:return Log4js.Level.WARN;case Logger.INFO:return Log4js.Level.INFO;case Logger.DEBUG:return Log4js.Level.DEBUG;case Logger.TRACE:return Log4js.Level.TRACE;case Logger.ALL:return Log4js.Level.ALL}};return{setLevel:function(nLevel){try{jsLogger.setLevel(convertESAPILevel(nLevel))}catch(e){this.error(org.owasp.esapi.Logger.SECURITY_FAILURE,"",e)}},trace:function(oEventType,sMessage,oException){this.log(Level.TRACE,oEventType,sMessage,oException)},debug:function(oEventType,sMessage,oException){this.log(Level.DEBUG,oEventType,sMessage,oException)},info:function(oEventType,sMessage,oException){this.log(Level.INFO,oEventType,sMessage,oException)},warning:function(oEventType,sMessage,oException){this.log(Level.WARN,oEventType,sMessage,oException)},error:function(oEventType,sMessage,oException){this.log(Level.ERROR,oEventType,sMessage,oException)},fatal:function(oEventType,sMessage,oException){this.log(Level.FATAL,oEventType,sMessage,oException)},log:function(oLevel,oEventType,sMessage,oException){switch(oLevel){case Level.TRACE:if(!jsLogger.isTraceEnabled()){return}break;case Level.DEBUG:if(!jsLogger.isDebugEnabled()){return}break;case Level.INFO:if(!jsLogger.isInfoEnabled()){return}break;case Level.WARNING:if(!jsLogger.isWarnEnabled()){return}break;case Level.ERROR:if(!jsLogger.isErrorEnabled()){return}break;case Level.FATAL:if(!jsLogger.isFatalEnabled()){return}break}if(!sMessage){sMessage=""}sMessage="["+oEventType.toString()+"] - "+sMessage;var clean=sMessage.replace("\n","_").replace("\r","_");if(encodingRequired){clean=encodingFunction(clean);if(clean!=sMessage){clean+=" [Encoded]"}}var appInfo=(logUrl?window.location.href:"")+(logApplicationName?"/"+$ESAPI.properties.application.Name:"");jsLogger.log(oLevel,(appInfo!=""?"["+appInfo+"] ":"")+clean,oException)},addAppender:function(oAppender){jsLogger.addAppender(oAppender)},isLogUrl:function(){return logUrl},setLogUrl:function(b){logUrl=b},isLogApplicationName:function(){return logApplicationName},setLogApplicationName:function(b){logApplicationName=b},isEncodingRequired:function(){return encodingRequired},setEncodingRequired:function(b){encodingRequired=b},setEncodingFunction:function(f){encodingFunction=f},isDebugEnabled:function(){return jsLogger.isDebugEnabled()},isErrorEnabled:function(){return jsLogger.isErrorEnabled()},isFatalEnabled:function(){return jsLogger.isFatalEnabled()},isInfoEnabled:function(){return jsLogger.isInfoEnabled()},isTraceEnabled:function(){return jsLogger.isTraceEnabled()},isWarningEnabled:function(){return jsLogger.isWarnEnabled()}}};var getLoggerConfig=function(moduleName){var logConfig=$ESAPI.properties.logging;if(logConfig[moduleName]){logConfig=logConfig[moduleName]}return logConfig};return{getLogger:function(moduleName){var key=(typeof moduleName=="string")?moduleName:moduleName.constructor.toString();var logger=loggersMap[key];if(!logger){logger=new Log4JSLogger(key);var logConfig=getLoggerConfig(moduleName);logger.setLevel(logConfig.Level);logger.setLogUrl(logConfig.LogUrl);logger.setLogApplicationName(logConfig.LogApplicationName);logger.setEncodingRequired(logConfig.EncodingRequired);if(logConfig.EncodingFunction){logger.setEncodingFunction(logConfig.EncodingFunction)}logConfig.Appenders.each(function(e){if(logConfig.Layout){e.setLayout(logConfig.Layout)}logger.addAppender(e)});loggersMap[key]=logger}return logger}}};$namespace("org.owasp.esapi.reference.validation");org.owasp.esapi.reference.validation.BaseValidationRule=function(sTypeName,oEncoder,oLocale){var typename=sTypeName;var encoder=oEncoder?oEncoder:$ESAPI.encoder();var allowNull=false;return{setAllowNull:function(b){allowNull=b},isAllowNull:function(){return allowNull},getTypeName:function(){return typename},setTypeName:function(s){typename=s},setEncoder:function(oEncoder){encoder=oEncoder},getEncoder:function(){return encoder},assertValid:function(sContext,sInput){this.getValid(sContext,sInput)},getValid:function(sContext,sInput,oValidationErrorList){var valid=null;try{valid=this.getValidInput(sContext,sInput)}catch(oValidationException){return this.sanitize(sContext,sInput)}return valid},getValidInput:function(sContext,sInput){return sInput},getSafe:function(sContext,sInput){var valid=null;try{valid=this.getValidInput(sContext,sInput)}catch(oValidationException){return this.sanitize(sContext,sInput)}return valid},sanitize:function(sContext,sInput){return sInput},isValid:function(sContext,sInput){var valid=false;try{this.getValidInput(sContext,sInput);valid=true}catch(oValidationException){return false}return valid},whitelist:function(sInput,aWhitelist){var stripped="";for(var i=0;i<sInput.length;i++){var c=sInput.charAt(i);if(aWhitelist.indexOf(c)>-1){stripped+=c}}return stripped},getUserMessage:function(sContext,sDefault,oContextValues){return this.getMessage(sContext+".Usr",sDefault+".Usr",oContextValues)},getLogMessage:function(sContext,sDefault,oContextValues){return this.getMessage(sContext+".Log",sDefault+".Log",oContextValues)},getMessage:function(sContext,sDefault,oContextValues){return resourceBundle.getString(sContext,oContextValues)?resourceBundle.getString(sContext,oContextValues):resourceBundle.getString(sDefault,oContextValues)},validationException:function(sContext,sDefault,sValidation,oContextValues){throw new org.owasp.esapi.reference.validation.ValidationException(this.getUserMessage(sContext+"."+sValidation,sDefault+"."+sValidation,oContextValues),this.getLogMessage(sContext+"."+sValidation,sDefault+"."+sValidation,oContextValues),sContext)}}};$namespace("org.owasp.esapi.reference.validation");org.owasp.esapi.reference.validation.CreditCardValidationRule=function(sTypeName,oEncoder,oLocale){var _super=new org.owasp.esapi.reference.validation.BaseValidationRule(sTypeName,oEncoder,oLocale);var _validationType="CreditCard";var maxCardLength=19;var ccrule;var readDefaultCreditCardRule=function(){var p=new RegExp($ESAPI.properties.validation.CreditCard);var ccr=new org.owasp.esapi.reference.validation.StringValidationRule("ccrule",_super.getEncoder(),oLocale,p);ccr.setMaxLength(maxCardLength);ccr.setAllowNull(false);return ccr};ccRule=readDefaultCreditCardRule();var validCreditCardFormat=function(ccNum){var digitsonly="";var c;for(var i=0;o<ccNum.length;i++){c=ccNum.charAt(i);if(c.match(/[0-9]/)){digitsonly+=c}}var sum=0,digit=0,addend=0,timesTwo=false;for(var j=digitsonly.length-1;j>=0;j--){digit=parseInt(digitsonly.substring(j,i+1));if(timesTwo){addend=digit*2;if(addend>9){addend-=9}}else{addend=digit}sum+=addend;timesTwo=!timesTwo}return sum%10==0};return{getMaxCardLength:function(){return maxCardLength},setMaxCardLength:function(n){maxCardLength=n},setAllowNull:_super.setAllowNull,isAllowNull:_super.isAllowNull,getTypeName:_super.getTypeName,setTypeName:_super.setTypeName,setEncoder:_super.setEncoder,getEncoder:_super.getEncoder,assertValid:_super.assertValid,getValid:_super.getValid,getValidInput:function(sContext,sInput){if(!sInput||sInput.trim()==""){if(this.isAllowNull()){return null}_super.validationException(sContext,_validationType,"Required",{context:sContext,input:sInput})}var canonical=ccrule.getValid(sContext,sInput);if(!validCreditCardFormat(canonical)){_super.validationException(sContext,_validationType,"Invalid",{context:sContext,input:sInput})}return canonical},getSafe:_super.getSafe,sanitize:function(sContext,sInput){return this.whitelist(sInput,org.owasp.esapi.EncoderConstants.CHAR_DIGITS)},isValid:_super.isValid,whitelist:_super.whitelist}};$namespace("org.owasp.esapi.reference.validation");org.owasp.esapi.reference.validation.DateValidationRule=function(sTypeName,oEncoder,oLocale){var _super=new org.owasp.esapi.reference.validation.BaseValidationRule(sTypeName,oEncoder,oLocale);var _validationTarget="Date";var format=DateFormat.getDateInstance();var safelyParse=function(sContext,sInput){if(!sContext||sContext.trim()==""){if(_super.isAllowNull()){return null}_super.validationException(sContext,_validationTarget,"Required",{context:sContext,input:sInput,format:format})}var canonical=_super.getEncoder().cananicalize(sInput);try{return format.parse(canonical)}catch(e){_super.validationException(sContext,_validationTarget,"Invalid",{context:sContext,input:sInput,format:format})}};return{setDateFormat:function(fmt){if(!fmt){throw new IllegalArgumentException("DateValidationRule.setDateFormat requires a non-null DateFormat")}format=fmt},setAllowNull:_super.setAllowNull,isAllowNull:_super.isAllowNull,getTypeName:_super.getTypeName,setTypeName:_super.setTypeName,setEncoder:_super.setEncoder,getEncoder:_super.getEncoder,assertValid:_super.assertValid,getValid:_super.getValid,getValidInput:function(sContext,sInput){return safelyParse(sContext,sInput)},getSafe:_super.getSafe,sanitize:function(sContext,sInput){var date=new Date(0);try{date=safelyParse(sContext,sInput)}catch(e){}return date},isValid:_super.isValid,whitelist:_super.whitelist}};$namespace("org.owasp.esapi.reference.validation");org.owasp.esapi.reference.validation.DefaultValidator=function(oEncoder,oLocale){var rules=Array();var encoder=oEncoder?oEncoder:$ESAPI.encoder();var locale=oLocale?oLocale:org.owasp.esapi.i18n.Locale.getDefault();var p=org.owasp.esapi.reference.validation;return{addRule:function(oValidationRule){rules[oValidationRule.getName()]=oValidationRule},getRule:function(sName){return rules[sName]},isValidInput:function(sContext,sInput,sType,nMaxLength,bAllowNull){try{this.getValidInput(sContext,sInput,sType,nMaxLength,bAllowNull);return true}catch(e){return false}},getValidInput:function(sContext,sInput,sType,nMaxLength,bAllowNull,oValidationErrorList){var rvr=new org.owasp.esapi.reference.validation.StringValidationRule(sType,encoder,locale);var p=new RegExp($ESAPI.properties.validation[sType]);if(p&&p instanceof RegExp){rvr.addWhitelistPattern(p)}else{throw new IllegalArgumentException("Invalid Type: "+sType+" not found.")}rvr.setMaxLength(nMaxLength);rvr.setAllowNull(bAllowNull);try{return rvr.getValid(sContext,sInput)}catch(e){if(e instanceof p.ValidationErrorList&&oValidationErrorList){oValidationErrorList.addError(sContext,e)}throw e}},isValidDate:function(sContext,sInput,oDateFormat,bAllowNull){try{this.getValidDate(sContext,sInput,oDateFormat,bAllowNull);return true}catch(e){return false}},getValidDate:function(sContext,sInput,oDateFormat,bAllowNull,oValidationErrorList){var dvr=new p.DateValidationRule(sContext,encoder,locale);dvr.setAllowNull(bAllowNull);dvr.setDateFormat(oDateFormat);try{return dvr.getValid(sContext,sInput)}catch(e){if(e instanceof p.ValidationErrorList&&oValidationErrorList){oValidationErrorList.addError(sContext,e)}throw e}},getValidCreditCard:function(sContext,sInput,bAllowNull,oValidationErrorList){var ccr=new p.CreditCardValidationRule(sContext,encoder,locale);ccr.setAllowNull(bAllowNull);try{return ccr.getValid(sContext,sInput)}catch(e){if(e instanceof p.ValidationErrorList&&oValidationErrorList){oValidationErrorList.addError(sContext,e)}throw e}},isValidCreditCard:function(sContext,sInput,bAllowNull){try{this.getValidCreditCard(sContext,sInput,bAllowNull);return true}catch(e){return false}},getValidNumber:function(sContext,sInput,bAllowNull,nMinValue,nMaxValue,oValidationErrorList){var nvr=new p.NumberValidationRule(sContext,encoder,locale,nMinValue,nMaxValue);nvr.setAllowNull(bAllowNull);try{return nvr.getValid(sContext,sInput)}catch(e){if(e instanceof p.ValidationErrorList&&oValidationErrorList){oValidationErrorList.addError(sContext,e)}throw e}},isValidNumber:function(sContext,sInput,bAllowNull,nMinValue,nMaxValue){try{this.getValidNumber(sContext,sInput,bAllowNull,nMinValue,nMaxValue);return true}catch(e){return false}},getValidInteger:function(sContext,sInput,bAllowNull,nMinValue,nMaxValue,oValidationErrorList){var nvr=new p.IntegerValidationRule(sContext,encoder,locale,nMinValue,nMaxValue);nvr.setAllowNull(bAllowNull);try{return nvr.getValid(sContext,sInput)}catch(e){if(e instanceof p.ValidationErrorList&&oValidationErrorList){oValidationErrorList.addError(sContext,e)}throw e}},isValidInteger:function(sContext,sInput,bAllowNull,nMinValue,nMaxValue){try{this.getValidInteger(sContext,sInput,bAllowNull,nMinValue,nMaxValue);return true}catch(e){return false}}}};$namespace("org.owasp.esapi.reference.validation");org.owasp.esapi.reference.validation.IntegerValidationRule=function(sTypeName,oEncoder,oLocale,nMinValue,nMaxValue){var _super=new org.owasp.esapi.reference.validation.BaseValidationRule(sTypeName,oEncoder,oLocale);var _validationTarget="Integer";var minValue=nMinValue?nMinValue:Number.MIN_VALUE;var maxValue=nMaxValue?nMaxValue:Number.MAX_VALUE;if(minValue>=maxValue){throw new IllegalArgumentException("minValue must be less than maxValue")}var safelyParse=function(sContext,sInput){if(!sInput||sInput.trim()==""){if(_super.allowNull()){return null}_super.validationException(sContext,_validationTarget,"Required",{context:sContext,input:sInput,minValue:minValue,maxValue:maxValue})}var canonical=_super.getEncoder().cananicalize(sInput);var n=parseInt(canonical);if(n=="NaN"){_super.validationException(sContext,_validationTarget,"NaN",{context:sContext,input:sInput,minValue:minValue,maxValue:maxValue})}if(n<minValue){_super.validationException(sContext,_validationTarget,"MinValue",{context:sContext,input:sInput,minValue:minValue,maxValue:maxValue})}if(n>maxValue){_super.validationException(sContext,_validationTarget,"MaxValue",{context:sContext,input:sInput,minValue:minValue,maxValue:maxValue})}return n};return{setMinValue:function(n){minValue=n},getMinValue:function(){return minValue},setMaxValue:function(n){maxValue=n},getMaxValue:function(){return maxValue},setAllowNull:_super.setAllowNull,isAllowNull:_super.isAllowNull,getTypeName:_super.getTypeName,setTypeName:_super.setTypeName,setEncoder:_super.setEncoder,getEncoder:_super.getEncoder,assertValid:_super.assertValid,getValid:_super.getValid,getValidInput:function(sContext,sInput){return safelyParse(sContext,sInput)},getSafe:_super.getSafe,sanitize:function(sContext,sInput){var n=0;try{n=safelyParse(sContext,sInput)}catch(e){}return n},isValid:_super.isValid,whitelist:_super.whitelist}};$namespace("org.owasp.esapi.reference.validation");org.owasp.esapi.reference.validation.NumberValidationRule=function(sTypeName,oEncoder,oLocale,fMinValue,fMaxValue){var _super=new org.owasp.esapi.reference.validation.BaseValidationRule(sTypeName,oEncoder,oLocale);var _validationTarget="Number";var minValue=fMinValue?fMinValue:Number.MIN_VALUE;var maxValue=fMaxValue?fMaxValue:Number.MAX_VALUE;if(minValue>=maxValue){throw new IllegalArgumentException("MinValue must be less that MaxValue")}var safelyParse=function(sContext,sInput){if(!sInput||sInput.trim()==""){if(_super.isAllowNull()){return null}_super.validationException(sContext,_validationTarget,"Required",{context:sContext,input:sInput,minValue:minValue,maxValue:maxValue})}var canonical=_super.getEncoder().cananicalize(sInput);var f=0;try{f=parseFloat(canonical)}catch(e){_super.validationException(sContext,_validationTarget,"Invalid",{context:sContext,input:sInput,minValue:minValue,maxValue:maxValue})}if(f=="NaN"){_super.validationException(sContext,_validationTarget,"NaN",{context:sContext,input:sInput,minValue:minValue,maxValue:maxValue})}if(f<minValue){_super.validationException(sContext,_validationTarget,"MinValue",{context:sContext,input:sInput,minValue:minValue,maxValue:maxValue})}if(f>maxValue){_super.validationException(sContext,_validationTarget,"MaxValue",{context:sContext,input:sInput,minValue:minValue,maxValue:maxValue})}return f};return{setMinValue:function(n){minValue=n},getMinValue:function(){return minValue},setMaxValue:function(n){maxValue=n},getMaxValue:function(){return maxValue},setAllowNull:_super.setAllowNull,isAllowNull:_super.isAllowNull,getTypeName:_super.getTypeName,setTypeName:_super.setTypeName,setEncoder:_super.setEncoder,getEncoder:_super.getEncoder,assertValid:_super.assertValid,getValid:_super.getValid,getValidInput:function(sContext,sInput){return safelyParse(sContext,sInput)},getSafe:_super.getSafe,sanitize:function(sContext,sInput){var n=0;try{n=safelyParse(sContext,sInput)}catch(e){}return n},isValid:_super.isValid,whitelist:_super.whitelist}};$namespace("org.owasp.esapi.reference.validation");org.owasp.esapi.reference.validation.StringValidationRule=function(sTypeName,oEncoder,oLocale,sWhiteListPattern){var _super=new org.owasp.esapi.reference.validation.BaseValidationRule(sTypeName,oEncoder,oLocale);var _validationTarget="String";var whitelistPatterns=Array();var blacklistPatterns=Array();var minLength=0;var maxLength=Number.MAX_VALUE;var validateInputAndCanonical=true;if(sWhiteListPattern){if(sWhiteListPattern instanceof String){whitelistPatterns.push(new RegExp(sWhiteListPattern))}else{if(sWhiteListPattern instanceof RegExp){whitelistPatterns.push(sWhiteListPattern)}else{throw new IllegalArgumentException("sWhiteListPattern must be a string containing RegExp or a RegExp Object")}}}var checkWhitelist=function(sContext,sInput,sOrig){whitelistPatterns.each(function(p){if(sInput.match(p)){_super.validationException(sContext,_validationTarget,"Whitelist",{context:sContext,input:sInput,orig:sOrig,pattern:p.toString(),minLength:minLength,maxLength:maxLength,validateInputAndCanonical:validateInputAndCanonical})}})};var checkBlacklist=function(sContext,sInput,sOrig){blacklistPatterns.each(function(p){if(sInput.match(p)){_super.validationException(sContext,_validationTarget,"Blacklist",{context:sContext,input:sInput,orig:sOrig,pattern:p.toString(),minLength:minLength,maxLength:maxLength,validateInputAndCanonical:validateInputAndCanonical})}})};var checkLength=function(sContext,sInput,sOrig){if(sInput.length<minLength){_super.validationException(sContext,_validationTarget,"MinLength",{context:sContext,input:sInput,orig:sOrig,minLength:minLength,maxLength:maxLength,validateInputAndCanonical:validateInputAndCanonical})}if(sInput.length>maxLength){_super.validationException(sContext,_validationTarget,"MaxLength",{context:sContext,input:sInput,orig:sOrig,minLength:minLength,maxLength:maxLength,validateInputAndCanonical:validateInputAndCanonical})}return sInput};var checkEmpty=function(sContext,sInput,sOrig){if(!sInput||sInput.trim()==""){if(_super.isAllowNull()){return null}_super.validationException(sContext,_validationTarget,"Required",{context:sContext,input:sInput,orig:sOrig,minLength:minLength,maxLength:maxLength,validateInputAndCanonical:validateInputAndCanonical})}};return{addWhitelistPattern:function(p){if(p instanceof String){whitelistPatterns.push(new RegExp(p))}else{if(p instanceof RegExp){whitelistPatterns.push(p)}else{throw new IllegalArgumentException("p must be a string containing RegExp or a RegExp Object")}}},addBlacklistPattern:function(p){if(p instanceof String){blacklistPatterns.push(new RegExp(p))}else{if(p instanceof RegExp){blacklistPatterns.push(p)}else{throw new IllegalArgumentException("p must be a string containing RegExp or a RegExp Object")}}},setMinLength:function(n){minLength=n},getMinLength:function(){return minLength},setMaxLength:function(n){maxLength=n},getMaxLength:function(){return maxLength},setValidateInputAndCanonical:function(b){validateInputAndCanonical=b},isValidateInputAndCanonical:function(){return validateInputAndCanonical},setAllowNull:_super.setAllowNull,isAllowNull:_super.isAllowNull,getTypeName:_super.getTypeName,setTypeName:_super.setTypeName,setEncoder:_super.setEncoder,getEncoder:_super.getEncoder,assertValid:_super.assertValid,getValid:_super.getValid,getValidInput:function(sContext,sInput){var canonical=null;if(checkEmpty(sContext,sInput)==null){return null}if(validateInputAndCanonical){checkLength(sContext,sInput);checkWhitelist(sContext,sInput);checkBlacklist(sContext,sInput)}canonical=this.getEncoder().cananicalize(sInput);if(checkEmpty(sContext,canonical,sInput)==null){return null}checkLength(sContext,canonical,sInput);checkWhitelist(sContext,canonical,sInput);checkBlacklist(sContext,canonical,sInput);return canonical},getSafe:_super.getSafe,sanitize:function(sContext,sInput){return this.whitelist(sInput,org.owasp.esapi.EncoderConstants.CHAR_ALNUM)},isValid:_super.isValid,whitelist:_super.whitelist}};$namespace("org.owasp.esapi.reference.validation");org.owasp.esapi.reference.validation.ValidationException=function(sUserMessage,sLogMessage){var oException,sContext;if(arguments[2]&&arguments[2] instanceof Exception){oException=arguments[2];if(arguments[3]&&arguments[3] instanceof String){sContext=arguments[3]}}else{if(arguments[2]&&arguments[2] instanceof String){sContext=arguments[2]}}var _super=new org.owasp.esapi.EnterpriseSecurityException(sUserMessage,sLogMessage,oException);return{setContext:function(s){sContext=s},getContext:function(){return sContext},getMessage:_super.getMessage,getUserMessage:_super.getMessage,getLogMessage:_super.getLogMessage,getStackTrace:_super.getStackTrace,printStackTrace:_super.printStackTrace}};$namespace("Base.esapi.properties");Base.esapi.properties={application:{Name:"Appzillon Application"},httputilities:{cookies:{ForceSecure:true}},logging:{Implementation:"",Level:org.owasp.esapi.Logger.ERROR,Appenders:[],LogUrl:false,LogApplicationName:false,EncodingRequired:true},encoder:{Implementation:org.owasp.esapi.reference.encoding.DefaultEncoder,AllowMultipleEncoding:false},localization:{StandardResourceBundle:"",DefaultLocale:"en-US"},validation:{Implementation:org.owasp.esapi.reference.validation.DefaultValidator,AccountName:"^[a-zA-Z0-9]{3,20}$",SafeString:"[a-zA-Z0-9\\-_+]*",Email:"^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\\.[a-zA-Z]{2,4}$",IPAddress:"^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$",URL:"^(ht|f)tp(s?)\\:\\/\\/[0-9a-zA-Z]([-.\\w]*[0-9a-zA-Z])*(:(0-9)*)*(\\/?)([a-zA-Z0-9\\-\\.\\?\\,\\:\\'\\/\\\\\\+=&amp;%\\$#_]*)?$",CreditCard:"^(\\d{4}[- ]?){3}\\d{4}$",SSN:"^(?!000)([0-6]\\d{2}|7([0-6]\\d|7[012]))([ -]?)(?!00)\\d\\d\\3(?!0000)\\d{4}$",HttpScheme:"^(http|https)$",HttpServerName:"^[a-zA-Z0-9_.\\-]*$",HttpParameterName:"^[a-zA-Z0-9_]{1,32}$",HttpParameterValue:"^[a-zA-Z0-9.\\-\\/+=_ ]*$",HttpCookieName:"^[a-zA-Z0-9\\-_]{1,32}$",HttpCookieValue:"^[a-zA-Z0-9\\-\\/+=_ ]*$"}};